<agent_config>
<% if @ossec_rootcheck == false then -%>
  <rootcheck>
    <disabled>yes</disabled>
  </rootcheck>
<% end -%>

<syscheck>
    <!-- Frequency that syscheck is executed -->
    <frequency><%= @ossec_syscheck_frequency %></frequency>
    <disabled>no</disabled>
  </syscheck>
</agent_config>

<agent_config os="Linux">
  <%= scope.function_template(["wazuh/fragments/_rootcheck_linux.erb"]) %>

  <%= scope.function_template(["wazuh/fragments/_syscheck_linux.erb"]) %>

  <!-- Log analysis -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/ossec/logs/active-responses.log</location>
  </localfile>

  <localfile>
    <log_format>command</log_format>
    <command>df -P</command>
    <frequency>360</frequency>
  </localfile>

  <localfile>
    <log_format>full_command</log_format>
    <command>netstat -tln | grep -v 127.0.0.1 | sort</command>
    <frequency>360</frequency>
  </localfile>

  <localfile>
    <log_format>full_command</log_format>
    <command>last -n 20</command>
    <frequency>360</frequency>
  </localfile>

</agent_config>

<agent_config os="Windows">
  <%= scope.function_template(["wazuh/fragments/_rootcheck_windows.erb"]) %>

  <%= scope.function_template(["wazuh/fragments/_syscheck_windows.erb"]) %>

  <localfile>
    <log_format>eventlog</log_format>
    <location>Application</location>
  </localfile>
  <localfile>
    <log_format>eventlog</log_format>
    <location>Security</location>
  </localfile>
  <localfile>
    <log_format>eventlog</log_format>
    <location>System</location>
  </localfile>
</agent_config>
